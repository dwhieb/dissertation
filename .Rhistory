data_100$log_rel_freq <- log2(data_100$rel_freq)
# language-specific data (update filenames of plots too)
# lang       <- "Nuuchahnulth"
# data_small <- data_small[which(data_small$language == lang), ]
# data_100   <- data_100[which(data_100$language == lang), ]
# models
model_small <- bam(
flexibility ~ te(log_rel_freq, dispersion),
data   = data_small,
method = "REML",
)
model_100 <- bam(
flexibility ~ te(log_rel_freq, dispersion),
data   = data_100,
method = "REML",
)
# contour plots
png(
filename = "stats/figures/freq-DP_vs_flexibility/interaction_contour.png",
height   = 500,
width    = 1000,
)
par(mfrow = c(1, 2))
plot(
model_small,
cex  = 0.5,
main = "Small Corpus",
pch  = 1,
ylim = c(0, 1),
)
plot(
model_100,
cex  = 0.5,
main = "100 Lexemes",
pch  = 1,
ylim = c(0, 1),
)
dev.off()
# heat maps
png(
filename = "stats/figures/freq-DP_vs_flexibility/interaction_heat.png",
height   = 500,
width    = 1000,
)
par(mfrow = c(1, 2))
vis.gam(
main      = "Small Corpus",
view      = c("log_rel_freq", "dispersion"),
plot.type = "contour",
too.far   = 0.1,
x         = model_small,
ylim      = c(0, 1),
)
vis.gam(
main      = "100 Lexemes",
view      = c("log_rel_freq", "dispersion"),
plot.type = "contour",
too.far   = 0.1,
x         = model_100,
ylim      = c(0, 1),
)
dev.off()
# 3D heat maps (looking top down the flexibility axis)
png(
filename = "stats/figures/freq-DP_vs_flexibility/interaction_3D-heat.png",
height   = 500,
width    = 1000,
)
par(mfrow = c(1, 2))
vis.gam(
main      = "Small Corpus",
phi       = 90,
plot.type = "persp",
r         = 5,
too.far   = 0.1,
view      = c("log_rel_freq", "dispersion"),
x         = model_small,
)
vis.gam(
main      = "100 Lexemes",
phi       = 90,
plot.type = "persp",
r         = 5,
too.far   = 0.1,
view      = c("log_rel_freq", "dispersion"),
x         = model_100,
)
dev.off()
# 3D perspective plots (without standard errors)
png(
filename = "stats/figures/freq-DP_vs_flexibility/interaction_3D.png",
height   = 500,
width    = 1000,
)
par(mfrow = c(1, 2))
vis.gam(
main      = "Small Corpus",
phi       = 5,
plot.type = "persp",
too.far   = 0.1,
view      = c("log_rel_freq", "dispersion"),
x         = model_small,
)
vis.gam(
main      = "100 Lexemes",
phi       = 5,
plot.type = "persp",
too.far   = 0.1,
view      = c("log_rel_freq", "dispersion"),
x         = model_100,
)
dev.off()
# 3D perspective plot (with standard errors)
png(
filename = "stats/figures/freq-DP_vs_flexibility/interaction_3Dse.png",
height   = 500,
width    = 1000,
)
par(mfrow = c(1, 2))
vis.gam(
main      = "Small Corpus",
phi       = 20,
plot.type = "persp",
se        = 2,
too.far   = 0.1,
view      = c("log_rel_freq", "dispersion"),
x         = model_small,
)
vis.gam(
main      = "100 Lexemes",
phi       = 20,
plot.type = "persp",
se        = 2,
too.far   = 0.1,
view      = c("log_rel_freq", "dispersion"),
x         = model_100,
)
dev.off()
# HYPOTHESES
# For low-frequency items, increased dispersion correlates strongly to lower flexibility.
# For high-frequency items, increased dispersion correlates strongly to high flexibility.
# Put differently: Items that are both frequent and evenly dispersed are very flexible.
# EXCEPT: This trend is reversed for 100-lexeme samples, especially for English.
# Hypothesis: This might just be do to overall frequency effects.
summary(model_small)
# Parametric coefficients:
#             Estimate Std. Error t value Pr(>|t|)
# (Intercept) 0.137237   0.009949   13.79   <2e-16 ***
#
# Approximate significance of smooth terms:
#                               edf Ref.df     F p-value
# te(log_rel_freq,dispersion) 3.972  4.692 2.257   0.058 .
#
# R-sq.(adj) =  0.0135   Deviance explained = 2.04%
# -REML = -5.8398  Scale est. = 0.056325  n = 569
# RESULTS
# For the small corpus, the effects of frequency and dispersion combined
# are marginally significant (p < .1).
#
# English: The results for the small corpus are insignificant.
# Nuuchahnulth: Frequency + dispersion are very highly significant (p < .001).
# - For low-frequency items, higher dispersion = higher flexibility
# - For high-frequency items, lower dispersion = higher flexibility
# - Explains 5.94% of the deviance. The effect is small.
summary(model_100)
# Parametric coefficients:
#             Estimate Std. Error t value Pr(>|t|)
# (Intercept)  0.20339    0.01703   11.94   <2e-16 ***
#
# Approximate significance of smooth terms:
#                               edf Ref.df     F p-value
# te(log_rel_freq,dispersion) 4.544  5.261 1.923  0.0929 .
#
# R-sq.(adj) =  0.0354   Deviance explained = 5.73%
# -REML = 2.8363  Scale est. = 0.058312  n = 201
# RESULTS
# For the 100-lexeme dataset, the effects of frequency and dispersion combined
# are marginally significant (p < .1).
#
# English: The results for the 100-lexeme dataset are insignificant.
# Nuuchahnulth: Frequency + dispersion are significant (p < .01).
# - The same patterns hold as for the small corpus
#   (unsurprising, given that they come from the same sample).
# - Explains 11.3% of the deviance.
tensor_model <- gam(
flexibility ~ s(log_rel_freq) + s(dispersion) + ti(log_rel_freq, dispersion),
data   = data_100,
method = "REML",
)
summary(tensor_model)
# NB: "The univariate smooths are additive, and then the interaction is an addition effect on top of those."
# Parametric coefficients:
#   Estimate Std. Error t value Pr(>|t|)
# (Intercept)  0.20215    0.02645   7.643 9.35e-13 ***
#
# Approximate significance of smooth terms:
#   edf Ref.df     F p-value
# s(log_rel_freq)             1.928  2.486 0.404   0.811
# s(dispersion)               1.000  1.000 1.493   0.223
# ti(log_rel_freq,dispersion) 1.929  2.291 0.932   0.455
#
# R-sq.(adj) =  0.0384   Deviance explained = 6.17%
# -REML = 8.3547  Scale est. = 0.058134  n = 201
# RESULTS
# The tensor model shows no significant interactions overall (for either dataset).
# English shows no significant interactions (for either dataset).
# For Nuuchahnulth in the small dataset, dispersion is very highly significant (p < 0.001).
# For Nuuchahnulth in the 100-lexeme dataset, frequency + dispersion is significant (p < 0.05)
png(
filename = "stats/figures/freq-DP_vs_flexibility/interaction_contour_100.png",
height   = 500,
width    = 1000,
)
plot(
model_100,
cex  = 0.5,
main = "log_2 relative frequency vs. dispersion",
pch  = 1,
ylim = c(0, 1),
)
dev.off()
png(
filename = "stats/figures/freq-DP_vs_flexibility/interaction_contour_100.png",
height   = 500,
width    = 500,
)
plot(
model_100,
cex  = 0.5,
main = "log_2 relative frequency vs. dispersion",
pch  = 1,
ylim = c(0, 1),
)
dev.off()
png(
filename = "stats/figures/freq-DP_vs_flexibility/interaction_contour_100.png",
height   = 1000,
width    = 1000,
)
plot(
model_100,
cex  = 0.5,
main = "log_2 relative frequency vs. dispersion",
pch  = 1,
ylim = c(0, 1),
)
dev.off()
# contour plot (100 lexemes)
png(
filename = "stats/figures/freq-DP_vs_flexibility/interaction_contour_100.png",
height   = 500,
width    = 500,
)
plot(
model_100,
cex  = 0.5,
main = "log_2 relative frequency vs. dispersion",
pch  = 1,
ylim = c(0, 1),
)
dev.off()
png(
filename = "stats/figures/freq-DP_vs_flexibility/interaction_heat_100.png",
height   = 500,
width    = 500,
)
vis.gam(
main      = "log_2 relative frequency vs. dispersion",
view      = c("log_rel_freq", "dispersion"),
plot.type = "contour",
too.far   = 0.1,
x         = model_100,
ylim      = c(0, 1),
)
dev.off()
png(
filename = "stats/figures/freq-DP_vs_flexibility/interaction_3Dse_100.png",
height   = 500,
width    = 500,
)
vis.gam(
main      = "log_2 relative frequency (x) vs. dispersion (y) vs. flexibility (z)",
phi       = 20,
plot.type = "persp",
se        = 2,
too.far   = 0.1,
view      = c("log_rel_freq", "dispersion"),
x         = model_100,
)
dev.off()
source("stats/scripts/load_small.R")
source("stats/scripts/load_100.R")
library(mgcv)
# data
data_small              <- load_small()
data_small$log_rel_freq <- log2(data_small$rel_freq)
data_100              <- load_100()
data_100$log_rel_freq <- log2(data_100$rel_freq)
# language-specific data (update filenames of plots too)
# lang       <- "Nuuchahnulth"
# data_small <- data_small[which(data_small$language == lang), ]
# data_100   <- data_100[which(data_100$language == lang), ]
# models
model_small <- bam(
flexibility ~ te(log_rel_freq, dispersion),
data   = data_small,
method = "REML",
)
model_100 <- bam(
flexibility ~ te(log_rel_freq, dispersion),
data   = data_100,
method = "REML",
)
# contour plots
png(
filename = "stats/figures/freq-DP_vs_flexibility/interaction_contour.png",
height   = 500,
width    = 1000,
)
par(mfrow = c(1, 2))
plot(
model_small,
cex  = 0.5,
main = "Small Corpus",
pch  = 1,
ylim = c(0, 1),
)
plot(
model_100,
cex  = 0.5,
main = "100 Lexemes",
pch  = 1,
ylim = c(0, 1),
)
dev.off()
# heat maps
png(
filename = "stats/figures/freq-DP_vs_flexibility/interaction_heat.png",
height   = 500,
width    = 1000,
)
par(mfrow = c(1, 2))
vis.gam(
main      = "Small Corpus",
view      = c("log_rel_freq", "dispersion"),
plot.type = "contour",
too.far   = 0.1,
x         = model_small,
ylim      = c(0, 1),
)
vis.gam(
main      = "100 Lexemes",
view      = c("log_rel_freq", "dispersion"),
plot.type = "contour",
too.far   = 0.1,
x         = model_100,
ylim      = c(0, 1),
)
dev.off()
# 3D heat maps (looking top down the flexibility axis)
png(
filename = "stats/figures/freq-DP_vs_flexibility/interaction_3D-heat.png",
height   = 500,
width    = 1000,
)
par(mfrow = c(1, 2))
vis.gam(
main      = "Small Corpus",
phi       = 90,
plot.type = "persp",
r         = 5,
too.far   = 0.1,
view      = c("log_rel_freq", "dispersion"),
x         = model_small,
)
vis.gam(
main      = "100 Lexemes",
phi       = 90,
plot.type = "persp",
r         = 5,
too.far   = 0.1,
view      = c("log_rel_freq", "dispersion"),
x         = model_100,
)
dev.off()
# 3D perspective plots (without standard errors)
png(
filename = "stats/figures/freq-DP_vs_flexibility/interaction_3D.png",
height   = 500,
width    = 1000,
)
par(mfrow = c(1, 2))
vis.gam(
main      = "Small Corpus",
phi       = 5,
plot.type = "persp",
too.far   = 0.1,
view      = c("log_rel_freq", "dispersion"),
x         = model_small,
)
vis.gam(
main      = "100 Lexemes",
phi       = 5,
plot.type = "persp",
too.far   = 0.1,
view      = c("log_rel_freq", "dispersion"),
x         = model_100,
)
dev.off()
# 3D perspective plot (with standard errors)
png(
filename = "stats/figures/freq-DP_vs_flexibility/interaction_3Dse.png",
height   = 500,
width    = 1000,
)
par(mfrow = c(1, 2))
vis.gam(
main      = "Small Corpus",
phi       = 20,
plot.type = "persp",
se        = 2,
too.far   = 0.1,
view      = c("log_rel_freq", "dispersion"),
x         = model_small,
)
vis.gam(
main      = "100 Lexemes",
phi       = 20,
plot.type = "persp",
se        = 2,
too.far   = 0.1,
view      = c("log_rel_freq", "dispersion"),
x         = model_100,
)
dev.off()
# HYPOTHESES
# For low-frequency items, increased dispersion correlates strongly to lower flexibility.
# For high-frequency items, increased dispersion correlates strongly to high flexibility.
# Put differently: Items that are both frequent and evenly dispersed are very flexible.
# EXCEPT: This trend is reversed for 100-lexeme samples, especially for English.
# Hypothesis: This might just be do to overall frequency effects.
summary(model_small)
# Parametric coefficients:
#             Estimate Std. Error t value Pr(>|t|)
# (Intercept) 0.137237   0.009949   13.79   <2e-16 ***
#
# Approximate significance of smooth terms:
#                               edf Ref.df     F p-value
# te(log_rel_freq,dispersion) 3.972  4.692 2.257   0.058 .
#
# R-sq.(adj) =  0.0135   Deviance explained = 2.04%
# -REML = -5.8398  Scale est. = 0.056325  n = 569
# RESULTS
# For the small corpus, the effects of frequency and dispersion combined
# are marginally significant (p < .1).
#
# English: The results for the small corpus are insignificant.
# Nuuchahnulth: Frequency + dispersion are very highly significant (p < .001).
# - For low-frequency items, higher dispersion = higher flexibility
# - For high-frequency items, lower dispersion = higher flexibility
# - Explains 5.94% of the deviance. The effect is small.
summary(model_100)
# Parametric coefficients:
#             Estimate Std. Error t value Pr(>|t|)
# (Intercept)  0.20339    0.01703   11.94   <2e-16 ***
#
# Approximate significance of smooth terms:
#                               edf Ref.df     F p-value
# te(log_rel_freq,dispersion) 4.544  5.261 1.923  0.0929 .
#
# R-sq.(adj) =  0.0354   Deviance explained = 5.73%
# -REML = 2.8363  Scale est. = 0.058312  n = 201
# RESULTS
# For the 100-lexeme dataset, the effects of frequency and dispersion combined
# are marginally significant (p < .1).
#
# English: The results for the 100-lexeme dataset are insignificant.
# Nuuchahnulth: Frequency + dispersion are significant (p < .01).
# - The same patterns hold as for the small corpus
#   (unsurprising, given that they come from the same sample).
# - Explains 11.3% of the deviance.
tensor_model <- gam(
flexibility ~ s(log_rel_freq) + s(dispersion) + ti(log_rel_freq, dispersion),
data   = data_100,
method = "REML",
)
summary(tensor_model)
# NB: "The univariate smooths are additive, and then the interaction is an addition effect on top of those."
# Parametric coefficients:
#   Estimate Std. Error t value Pr(>|t|)
# (Intercept)  0.20215    0.02645   7.643 9.35e-13 ***
#
# Approximate significance of smooth terms:
#   edf Ref.df     F p-value
# s(log_rel_freq)             1.928  2.486 0.404   0.811
# s(dispersion)               1.000  1.000 1.493   0.223
# ti(log_rel_freq,dispersion) 1.929  2.291 0.932   0.455
#
# R-sq.(adj) =  0.0384   Deviance explained = 6.17%
# -REML = 8.3547  Scale est. = 0.058134  n = 201
# RESULTS
# The tensor model shows no significant interactions overall (for either dataset).
# English shows no significant interactions (for either dataset).
# For Nuuchahnulth in the small dataset, dispersion is very highly significant (p < 0.001).
# For Nuuchahnulth in the 100-lexeme dataset, frequency + dispersion is significant (p < 0.05)
summary(model_100)
tensor_model <- gam(
flexibility ~ s(log_rel_freq) + s(dispersion) + ti(log_rel_freq, dispersion),
data   = data_100,
method = "REML",
)
summary(tensor_model)
