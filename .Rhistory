# The middle frequencies predict a flexibility rating of zero.
# The extreme frequencies (low or high) predict higher flexibility ratings.
# 3D perspective plot (without standard errors)
png(
filename = "stats/figures/freq-DP_vs_flexibility/interaction_3D.png",
height   = 500,
width    = 1000,
)
par(mfrow = c(1, 2))
vis.gam(
phi       = 30,
plot.type = "persp",
too.far   = 0.1,
view      = c("log_rel_freq", "dispersion"),
x         = model_small,
)
vis.gam(
phi       = 30,
plot.type = "persp",
too.far   = 0.1,
view      = c("log_rel_freq", "dispersion"),
x         = model_100,
)
dev.off()
# 3D perspective plot (without standard errors)
png(
filename = "stats/figures/freq-DP_vs_flexibility/interaction_3D.png",
height   = 500,
width    = 1000,
)
par(mfrow = c(1, 2))
vis.gam(
phi       = 35,
plot.type = "persp",
too.far   = 0.1,
view      = c("log_rel_freq", "dispersion"),
x         = model_small,
)
vis.gam(
phi       = 35,
plot.type = "persp",
too.far   = 0.1,
view      = c("log_rel_freq", "dispersion"),
x         = model_100,
)
dev.off()
# 3D perspective plot (without standard errors)
png(
filename = "stats/figures/freq-DP_vs_flexibility/interaction_3D.png",
height   = 500,
width    = 1000,
)
par(mfrow = c(1, 2))
vis.gam(
phi       = -10,
plot.type = "persp",
too.far   = 0.1,
view      = c("log_rel_freq", "dispersion"),
x         = model_small,
)
vis.gam(
phi       = -10,
plot.type = "persp",
too.far   = 0.1,
view      = c("log_rel_freq", "dispersion"),
x         = model_100,
)
dev.off()
# 3D perspective plot (without standard errors)
png(
filename = "stats/figures/freq-DP_vs_flexibility/interaction_3D.png",
height   = 500,
width    = 1000,
)
par(mfrow = c(1, 2))
vis.gam(
plot.type = "persp",
too.far   = 0.1,
view      = c("log_rel_freq", "dispersion"),
x         = model_small,
)
vis.gam(
plot.type = "persp",
too.far   = 0.1,
view      = c("log_rel_freq", "dispersion"),
x         = model_100,
)
dev.off()
# 3D perspective plot (without standard errors)
png(
filename = "stats/figures/freq-DP_vs_flexibility/interaction_3D.png",
height   = 500,
width    = 1000,
)
par(mfrow = c(1, 2))
vis.gam(
phi       = 35,
plot.type = "persp",
too.far   = 0.1,
view      = c("log_rel_freq", "dispersion"),
x         = model_small,
)
vis.gam(
phi       = 35,
plot.type = "persp",
too.far   = 0.1,
view      = c("log_rel_freq", "dispersion"),
x         = model_100,
)
dev.off()
# 3D perspective plot (without standard errors)
png(
filename = "stats/figures/freq-DP_vs_flexibility/interaction_3D.png",
height   = 500,
width    = 1000,
)
par(mfrow = c(1, 2))
vis.gam(
phi       = 30,
plot.type = "persp",
too.far   = 0.1,
view      = c("log_rel_freq", "dispersion"),
x         = model_small,
)
vis.gam(
phi       = 30,
plot.type = "persp",
too.far   = 0.1,
view      = c("log_rel_freq", "dispersion"),
x         = model_100,
)
dev.off()
png(
filename = "stats/figures/freq-DP_vs_flexibility/interaction_3D.png",
height   = 500,
width    = 1000,
)
par(mfrow = c(1, 2))
vis.gam(
phi       = 25,
plot.type = "persp",
too.far   = 0.1,
view      = c("log_rel_freq", "dispersion"),
x         = model_small,
)
vis.gam(
phi       = 25,
plot.type = "persp",
too.far   = 0.1,
view      = c("log_rel_freq", "dispersion"),
x         = model_100,
)
dev.off()
# 3D perspective plot (without standard errors)
png(
filename = "stats/figures/freq-DP_vs_flexibility/interaction_3D.png",
height   = 500,
width    = 1000,
)
par(mfrow = c(1, 2))
vis.gam(
phi       = 15,
plot.type = "persp",
too.far   = 0.1,
view      = c("log_rel_freq", "dispersion"),
x         = model_small,
)
vis.gam(
phi       = 15,
plot.type = "persp",
too.far   = 0.1,
view      = c("log_rel_freq", "dispersion"),
x         = model_100,
)
dev.off()
# 3D perspective plot (without standard errors)
png(
filename = "stats/figures/freq-DP_vs_flexibility/interaction_3D.png",
height   = 500,
width    = 1000,
)
par(mfrow = c(1, 2))
vis.gam(
#phi       = 15,
plot.type = "persp",
too.far   = 0.1,
view      = c("log_rel_freq", "dispersion"),
x         = model_small,
)
vis.gam(
#phi       = 15,
plot.type = "persp",
too.far   = 0.1,
view      = c("log_rel_freq", "dispersion"),
x         = model_100,
)
dev.off()
png(
filename = "stats/figures/freq-DP_vs_flexibility/interaction_3D.png",
height   = 500,
width    = 1000,
)
par(mfrow = c(1, 2))
vis.gam(
phi       = 0,
plot.type = "persp",
too.far   = 0.1,
view      = c("log_rel_freq", "dispersion"),
x         = model_small,
)
vis.gam(
phi       = 0,
plot.type = "persp",
too.far   = 0.1,
view      = c("log_rel_freq", "dispersion"),
x         = model_100,
)
dev.off()
png(
filename = "stats/figures/freq-DP_vs_flexibility/interaction_3D.png",
height   = 500,
width    = 1000,
)
par(mfrow = c(1, 2))
vis.gam(
phi       = 5,
plot.type = "persp",
too.far   = 0.1,
view      = c("log_rel_freq", "dispersion"),
x         = model_small,
)
vis.gam(
phi       = 5,
plot.type = "persp",
too.far   = 0.1,
view      = c("log_rel_freq", "dispersion"),
x         = model_100,
)
dev.off()
png(
filename = "stats/figures/freq-DP_vs_flexibility/interaction_3D.png",
height   = 500,
width    = 1000,
)
par(mfrow = c(1, 2))
vis.gam(
phi       = 90,
plot.type = "persp",
too.far   = 0.1,
view      = c("log_rel_freq", "dispersion"),
x         = model_small,
)
vis.gam(
phi       = 90,
plot.type = "persp",
too.far   = 0.1,
view      = c("log_rel_freq", "dispersion"),
x         = model_100,
)
dev.off()
# 3D perspective plot (without standard errors)
png(
filename = "stats/figures/freq-DP_vs_flexibility/interaction_3D.png",
height   = 500,
width    = 1000,
)
par(mfrow = c(1, 2))
vis.gam(
phi       = 90,
plot.type = "persp",
r         = 50,
too.far   = 0.1,
view      = c("log_rel_freq", "dispersion"),
x         = model_small,
)
vis.gam(
phi       = 90,
plot.type = "persp",
too.far   = 0.1,
view      = c("log_rel_freq", "dispersion"),
x         = model_100,
)
dev.off()
# 3D perspective plot (without standard errors)
png(
filename = "stats/figures/freq-DP_vs_flexibility/interaction_3D.png",
height   = 500,
width    = 1000,
)
par(mfrow = c(1, 2))
vis.gam(
phi       = 90,
plot.type = "persp",
r         = 25,
too.far   = 0.1,
view      = c("log_rel_freq", "dispersion"),
x         = model_small,
)
vis.gam(
phi       = 90,
plot.type = "persp",
too.far   = 0.1,
view      = c("log_rel_freq", "dispersion"),
x         = model_100,
)
dev.off()
# 3D perspective plot (without standard errors)
png(
filename = "stats/figures/freq-DP_vs_flexibility/interaction_3D.png",
height   = 500,
width    = 1000,
)
par(mfrow = c(1, 2))
vis.gam(
phi       = 90,
plot.type = "persp",
r         = 5,
too.far   = 0.1,
view      = c("log_rel_freq", "dispersion"),
x         = model_small,
)
vis.gam(
phi       = 90,
plot.type = "persp",
too.far   = 0.1,
view      = c("log_rel_freq", "dispersion"),
x         = model_100,
)
dev.off()
# 3D perspective plot (without standard errors)
png(
filename = "stats/figures/freq-DP_vs_flexibility/interaction_3D.png",
height   = 500,
width    = 1000,
)
par(mfrow = c(1, 2))
vis.gam(
phi       = 90,
plot.type = "persp",
r         = 5,
too.far   = 0.1,
view      = c("log_rel_freq", "dispersion"),
x         = model_small,
)
vis.gam(
phi       = 90,
plot.type = "persp",
r         = 5,
too.far   = 0.1,
view      = c("log_rel_freq", "dispersion"),
x         = model_100,
)
dev.off()
png(
filename = "stats/figures/freq-DP_vs_flexibility/interaction_3D.png",
height   = 500,
width    = 1000,
)
par(mfrow = c(1, 2))
vis.gam(
phi       = 5,
plot.type = "persp",
too.far   = 0.1,
view      = c("log_rel_freq", "dispersion"),
x         = model_small,
)
vis.gam(
phi       = 5,
plot.type = "persp",
too.far   = 0.1,
view      = c("log_rel_freq", "dispersion"),
x         = model_100,
)
dev.off()
source("stats/scripts/load_small.R")
source("stats/scripts/load_100.R")
library(mgcv)
# small corpus
data_small              <- load_small()
data_small$log_rel_freq <- log2(data_small$rel_freq)
model_small <- bam(
flexibility ~ te(log_rel_freq, dispersion),
data   = data_small,
method = "REML",
)
png(
filename = "stats/figures/freq-DP_vs_flexibility/interaction_small.png",
height   = 500,
width    = 1000,
)
# 100 lexemes
data_100              <- load_100()
data_100$log_rel_freq <- log2(data_100$rel_freq)
model_100 <- bam(
flexibility ~ te(log_rel_freq, dispersion),
data   = data_100,
method = "REML",
)
# contour plots
png(
filename = "stats/figures/freq-DP_vs_flexibility/interaction_contour.png",
height   = 500,
width    = 1000,
)
par(mfrow = c(1, 2))
plot(
model_small,
main = "Small Corpus",
cex  = 0.5,
pch  = 1,
)
plot(
model_100,
main = "100 Lexemes",
cex  = 0.5,
pch  = 1,
)
dev.off()
# heat maps
png(
filename = "stats/figures/freq-DP_vs_flexibility/interaction_heat.png",
height   = 500,
width    = 1000,
)
par(mfrow = c(1, 2))
vis.gam(
x         = model_small,
view      = c("log_rel_freq", "dispersion"),
plot.type = "contour",
too.far   = 0.1,
)
vis.gam(
x         = model_100,
view      = c("log_rel_freq", "dispersion"),
plot.type = "contour",
too.far   = 0.1,
)
dev.off()
# 3D heat maps (looking top down the flexibility axis)
png(
filename = "stats/figures/freq-DP_vs_flexibility/interaction_3D-heat.png",
height   = 500,
width    = 1000,
)
par(mfrow = c(1, 2))
vis.gam(
phi       = 90,
plot.type = "persp",
r         = 5,
too.far   = 0.1,
view      = c("log_rel_freq", "dispersion"),
x         = model_small,
)
vis.gam(
phi       = 90,
plot.type = "persp",
r         = 5,
too.far   = 0.1,
view      = c("log_rel_freq", "dispersion"),
x         = model_100,
)
dev.off()
# 3D perspective plots (without standard errors)
png(
filename = "stats/figures/freq-DP_vs_flexibility/interaction_3D.png",
height   = 500,
width    = 1000,
)
par(mfrow = c(1, 2))
vis.gam(
phi       = 5,
plot.type = "persp",
too.far   = 0.1,
view      = c("log_rel_freq", "dispersion"),
x         = model_small,
)
vis.gam(
phi       = 5,
plot.type = "persp",
too.far   = 0.1,
view      = c("log_rel_freq", "dispersion"),
x         = model_100,
)
dev.off()
# 3D perspective plot (with standard errors)
png(
filename = "stats/figures/freq-DP_vs_flexibility/interaction_3Dse.png",
height   = 500,
width    = 1000,
)
par(mfrow = c(1, 2))
vis.gam(
phi       = 20,
plot.type = "persp",
se        = 2,
too.far   = 0.1,
view      = c("log_rel_freq", "dispersion"),
x         = model_small,
)
vis.gam(
phi       = 20,
plot.type = "persp",
se        = 2,
too.far   = 0.1,
view      = c("log_rel_freq", "dispersion"),
x         = model_100,
)
dev.off()
# RESULTS
# The middle frequencies predict a flexibility rating of zero.
# The extreme frequencies (low or high) predict higher flexibility ratings.
dev.off()
