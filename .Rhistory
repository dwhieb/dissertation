x    = flexibility,
fill = language
)) +
theme_minimal() +
theme(
axis.text.y        = element_blank(),
axis.ticks.y       = element_blank(),
axis.title.y       = element_blank(),
panel.grid.major.y = element_blank(),
panel.grid.minor.y = element_blank(),
plot.margin        = margin(0, 0.5, 0.5, 0.5, "cm"),
strip.text.x       = element_blank()
) +
geom_boxplot(
na.rm       = TRUE,
notch       = TRUE,
show.legend = FALSE,
width       = 0.5
) +
xlim(0, 1) +
ylim(-0.5, 0.5) +
facet_grid(cols = vars(language))
grid <- plot_grid(
histogram,
scatterplot,
boxplot,
align = "v",
ncol  = 1,
nrow  = 3,
rel_heights = c(1, 3.5, 1)
)
grid
ggsave(
"stats/figures/dispersion_vs_flex/comparison.png",
grid
)
library(cowplot)
library(ggplot2)
source("stats/scripts/load_all_data.R")
data              <- load_all_data()
data              <- data[which(data$flexibility != "NaN"), ]
data_nonzero      <- data[which(data$flexibility > 0), ]
data_English      <- data[which(language == "English"), ]
data_Nuuchahnulth <- data[which(language == "Nuuchahnulth"), ]
attach(data)
model_English      <- lm(data_English$flexibility~data_English$dispersion)
model_Nuuchahnulth <- lm(data_Nuuchahnulth$flexibility~data_Nuuchahnulth$dispersion)
models <- data.frame(
c("English", "Nuuchahnulth"),
c(model_English$coefficients[1], model_Nuuchahnulth$coefficients[1]),
c(model_English$coefficients[2], model_Nuuchahnulth$coefficients[2])
)
colnames(models) <- c("language", "intercepts", "slopes")
histogram <- ggplot(data_nonzero, aes(
x     = flexibility,
fill  = language
)) +
theme_minimal() +
theme(
axis.text        = element_blank(),
axis.title       = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
plot.margin      = margin(0.5, 0.5, 0, 0.5, "cm")
) +
geom_histogram(
binwidth    = 0.05,
color       = "black",
show.legend = FALSE
) +
xlim(0, 1) +
facet_grid(cols = vars(language))
scatterplot <- ggplot(data, aes(
x     = flexibility,
y     = dispersion,
color = language,
shape = language
)) +
ylab("dispersion (Deviation of Proportions)") +
theme_minimal() +
theme(
axis.text.x  = element_blank(),
axis.title.x = element_blank(),
plot.margin  = margin(0, 0.5, 0, 0.5, "cm"),
strip.text.x = element_blank()
) +
geom_point(
show.legend = FALSE,
size = 1
) +
geom_rug(
show.legend = FALSE
) +
geom_density2d(
show.legend = FALSE
) +
geom_abline(
aes(
color     = language,
intercept = intercepts,
slope     = slopes
),
data        = models,
show.legend = FALSE,
size        = 0.75
) +
xlim(0, 1) +
facet_grid(cols = vars(language))
boxplot <- ggplot(data, aes(
x    = flexibility,
fill = language
)) +
theme_minimal() +
theme(
axis.text.y        = element_blank(),
axis.ticks.y       = element_blank(),
axis.title.y       = element_blank(),
panel.grid.major.y = element_blank(),
panel.grid.minor.y = element_blank(),
plot.margin        = margin(0, 0.5, 0.5, 0.5, "cm"),
strip.text.x       = element_blank()
) +
geom_boxplot(
na.rm       = TRUE,
notch       = TRUE,
show.legend = FALSE,
width       = 0.5
) +
xlim(0, 1) +
ylim(-0.5, 0.5) +
facet_grid(cols = vars(language))
grid <- plot_grid(
histogram,
scatterplot,
boxplot,
align = "v",
ncol  = 1,
nrow  = 3,
rel_heights = c(1, 3.5, 1)
)
grid
ggsave(
"stats/figures/dispersion_vs_flex/comparison.png",
grid
)
library(cowplot)
library(ggplot2)
source("stats/scripts/load_all_data.R")
data              <- load_all_data()
data              <- data[which(data$flexibility != "NaN"), ]
data_nonzero      <- data[which(data$flexibility > 0), ]
data_English      <- data[which(language == "English"), ]
data_Nuuchahnulth <- data[which(language == "Nuuchahnulth"), ]
attach(data)
model_English      <- lm(data_English$flexibility~data_English$dispersion)
model_Nuuchahnulth <- lm(data_Nuuchahnulth$flexibility~data_Nuuchahnulth$dispersion)
models <- data.frame(
c("English", "Nuuchahnulth"),
c(model_English$coefficients[1], model_Nuuchahnulth$coefficients[1]),
c(model_English$coefficients[2], model_Nuuchahnulth$coefficients[2])
)
colnames(models) <- c("language", "intercepts", "slopes")
histogram <- ggplot(data_nonzero, aes(
x     = flexibility,
fill  = language
)) +
theme_minimal() +
theme(
axis.text        = element_blank(),
axis.title       = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
plot.margin      = margin(0.5, 0.5, 0, 0.5, "cm")
) +
geom_histogram(
binwidth    = 0.05,
color       = "black",
show.legend = FALSE
) +
xlim(0, 1) +
facet_grid(cols = vars(language))
scatterplot <- ggplot(data, aes(
x     = flexibility,
y     = dispersion,
color = language,
shape = language
)) +
ylab("dispersion (Deviation of Proportions)") +
theme_minimal() +
theme(
axis.text.x  = element_blank(),
axis.title.x = element_blank(),
plot.margin  = margin(0, 0.5, 0, 0.5, "cm"),
strip.text.x = element_blank()
) +
geom_point(
show.legend = FALSE,
size = 1
) +
geom_rug(
show.legend = FALSE
) +
geom_density2d(
show.legend = FALSE
) +
geom_abline(
aes(
color     = language,
intercept = intercepts,
slope     = slopes
),
data        = models,
show.legend = FALSE,
size        = 0.75
) +
xlim(0, 1) +
facet_grid(cols = vars(language))
boxplot <- ggplot(data_nonzero, aes(
x    = flexibility,
fill = language
)) +
theme_minimal() +
theme(
axis.text.y        = element_blank(),
axis.ticks.y       = element_blank(),
axis.title.y       = element_blank(),
panel.grid.major.y = element_blank(),
panel.grid.minor.y = element_blank(),
plot.margin        = margin(0, 0.5, 0.5, 0.5, "cm"),
strip.text.x       = element_blank()
) +
geom_boxplot(
na.rm       = TRUE,
notch       = TRUE,
show.legend = FALSE,
width       = 0.5
) +
xlim(0, 1) +
ylim(-0.5, 0.5) +
facet_grid(cols = vars(language))
grid <- plot_grid(
histogram,
scatterplot,
boxplot,
align = "v",
ncol  = 1,
nrow  = 3,
rel_heights = c(1, 3.5, 1)
)
grid
ggsave(
"stats/figures/dispersion_vs_flex/comparison.png",
grid
)
library(cowplot)
library(ggplot2)
source("stats/scripts/load_all_data.R")
data              <- load_all_data()
data              <- data[which(data$flexibility != "NaN"), ]
data_nonzero      <- data[which(data$flexibility > 0), ]
data_English      <- data[which(language == "English"), ]
data_Nuuchahnulth <- data[which(language == "Nuuchahnulth"), ]
attach(data)
model_English      <- lm(data_English$flexibility~data_English$dispersion)
model_Nuuchahnulth <- lm(data_Nuuchahnulth$flexibility~data_Nuuchahnulth$dispersion)
models <- data.frame(
c("English", "Nuuchahnulth"),
c(model_English$coefficients[1], model_Nuuchahnulth$coefficients[1]),
c(model_English$coefficients[2], model_Nuuchahnulth$coefficients[2])
)
colnames(models) <- c("language", "intercepts", "slopes")
histogram <- ggplot(data_nonzero, aes(
x     = flexibility,
fill  = language
)) +
theme_minimal() +
theme(
axis.text        = element_blank(),
axis.title       = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
plot.margin      = margin(0.5, 0.5, 0, 0.5, "cm")
) +
geom_histogram(
binwidth    = 0.05,
color       = "black",
show.legend = FALSE
) +
xlim(0, 1) +
facet_grid(cols = vars(language))
scatterplot <- ggplot(data, aes(
x     = flexibility,
y     = dispersion,
color = language,
shape = language
)) +
ylab("dispersion (Deviation of Proportions)") +
theme_minimal() +
theme(
axis.text.x  = element_blank(),
axis.title.x = element_blank(),
plot.margin  = margin(0, 0.5, 0, 0.5, "cm"),
strip.text.x = element_blank()
) +
geom_point(
show.legend = FALSE,
size = 1
) +
geom_rug(
show.legend = FALSE
) +
geom_density2d(
data_nonzero,
show.legend = FALSE
) +
geom_abline(
aes(
color     = language,
intercept = intercepts,
slope     = slopes
),
data        = models,
show.legend = FALSE,
size        = 0.75
) +
xlim(0, 1) +
facet_grid(cols = vars(language))
boxplot <- ggplot(data_nonzero, aes(
x    = flexibility,
fill = language
)) +
theme_minimal() +
theme(
axis.text.y        = element_blank(),
axis.ticks.y       = element_blank(),
axis.title.y       = element_blank(),
panel.grid.major.y = element_blank(),
panel.grid.minor.y = element_blank(),
plot.margin        = margin(0, 0.5, 0.5, 0.5, "cm"),
strip.text.x       = element_blank()
) +
geom_boxplot(
na.rm       = TRUE,
notch       = TRUE,
show.legend = FALSE,
width       = 0.5
) +
xlim(0, 1) +
ylim(-0.5, 0.5) +
facet_grid(cols = vars(language))
grid <- plot_grid(
histogram,
scatterplot,
boxplot,
align = "v",
ncol  = 1,
nrow  = 3,
rel_heights = c(1, 3.5, 1)
)
grid
ggsave(
"stats/figures/dispersion_vs_flex/comparison.png",
grid
)
library(cowplot)
library(ggplot2)
source("stats/scripts/load_all_data.R")
data              <- load_all_data()
data              <- data[which(data$flexibility != "NaN"), ]
data_nonzero      <- data[which(data$flexibility > 0), ]
data_English      <- data[which(language == "English"), ]
data_Nuuchahnulth <- data[which(language == "Nuuchahnulth"), ]
attach(data)
model_English      <- lm(data_English$flexibility~data_English$dispersion)
model_Nuuchahnulth <- lm(data_Nuuchahnulth$flexibility~data_Nuuchahnulth$dispersion)
models <- data.frame(
c("English", "Nuuchahnulth"),
c(model_English$coefficients[1], model_Nuuchahnulth$coefficients[1]),
c(model_English$coefficients[2], model_Nuuchahnulth$coefficients[2])
)
colnames(models) <- c("language", "intercepts", "slopes")
histogram <- ggplot(data_nonzero, aes(
x     = flexibility,
fill  = language
)) +
theme_minimal() +
theme(
axis.text        = element_blank(),
axis.title       = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
plot.margin      = margin(0.5, 0.5, 0, 0.5, "cm")
) +
geom_histogram(
binwidth    = 0.05,
color       = "black",
show.legend = FALSE
) +
xlim(0, 1) +
facet_grid(cols = vars(language))
scatterplot <- ggplot(data, aes(
x     = flexibility,
y     = dispersion,
color = language,
shape = language
)) +
ylab("dispersion (Deviation of Proportions)") +
theme_minimal() +
theme(
axis.text.x  = element_blank(),
axis.title.x = element_blank(),
plot.margin  = margin(0, 0.5, 0, 0.5, "cm"),
strip.text.x = element_blank()
) +
geom_point(
show.legend = FALSE,
size = 1
) +
geom_rug(
show.legend = FALSE
) +
geom_density2d(
data = data_nonzero,
show.legend = FALSE
) +
geom_abline(
aes(
color     = language,
intercept = intercepts,
slope     = slopes
),
data        = models,
show.legend = FALSE,
size        = 0.75
) +
xlim(0, 1) +
facet_grid(cols = vars(language))
boxplot <- ggplot(data_nonzero, aes(
x    = flexibility,
fill = language
)) +
theme_minimal() +
theme(
axis.text.y        = element_blank(),
axis.ticks.y       = element_blank(),
axis.title.y       = element_blank(),
panel.grid.major.y = element_blank(),
panel.grid.minor.y = element_blank(),
plot.margin        = margin(0, 0.5, 0.5, 0.5, "cm"),
strip.text.x       = element_blank()
) +
geom_boxplot(
na.rm       = TRUE,
notch       = TRUE,
show.legend = FALSE,
width       = 0.5
) +
xlim(0, 1) +
ylim(-0.5, 0.5) +
facet_grid(cols = vars(language))
grid <- plot_grid(
histogram,
scatterplot,
boxplot,
align = "v",
ncol  = 1,
nrow  = 3,
rel_heights = c(1, 3.5, 1)
)
grid
ggsave(
"stats/figures/dispersion_vs_flex/comparison.png",
grid
)
data <- load_all_data()
data <- data[which(data$flexibility != "NaN"), ]
attach(data)
# Q: Does dispersion correlate with degree of flexibility?
# Hypothesis: Yes, archlexemes that are more evenly dispersed are more flexible.
# Note: Despite the directional hypothesis, this is a two-tailed test.
# There is no principled reason for ruling out in advance the possibility
# that the direction of correlation could be negative.
# H0: Dispersion and flexibility do not correlate.
# H1: Dispersion and flexibility correlate.
# First test for all data, independent of language
cov(dispersion, flexibility) # 0.05170578
# There exists a positive correlation
tau <- cor(flexibility, dispersion, method = "kendall"); tau
t2  <- tau^2 * 100; t2
cor.test(flexibility, dispersion, method = "kendall")
cov(Eng$dispersion, Eng$flexibility) # -0.02180398: negative correlation
cov(Nuu$dispersion, Nuu$flexibility) #  0.05099984: positive correlation
Eng <- data[which(language == "English"), ]
Nuu <- data[which(language == "Nuuchahnulth"), ]
cov(Eng$dispersion, Eng$flexibility) # -0.02180398: negative correlation
cov(Nuu$dispersion, Nuu$flexibility) #  0.05099984: positive correlation
tau_Eng <- cor(Eng$flexibility, Eng$dispersion, method = "kendall"); tau
t2_Eng  <- tau^2 * 100; t2
tau_Nuu <- cor(Nuu$flexibility, Nuu$dispersion, method = "kendall"); tau
t2_Nuu  <- tau^2 * 100; t2
# τ   = 0.4145373
# τ^2 = 17.18412
tau_Eng <- cor(Eng$flexibility, Eng$dispersion, method = "kendall"); tau
t2_Eng  <- tau^2 * 100; t2
# τ   = -0.323203
# τ^2 = 10.44602
cov(Eng$dispersion, Eng$flexibility) #  0.00192300: positive correlation
cov(Nuu$dispersion, Nuu$flexibility) # -0.00793939: negative correlation
tau_Eng <- cor(Eng$flexibility, Eng$dispersion, method = "kendall"); tau
t2_Eng  <- tau^2 * 100; t2
cor.test(Eng$flexibility, Eng$dispersion, method = "kendall")
cor.test(Nuu$flexibility, Nuu$dispersion, method = "kendall")
